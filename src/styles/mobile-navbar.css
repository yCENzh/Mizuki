/**
 * 导航栏半透明样式
 * Navbar Translucent Effects Styles
 * 只有当页面启用banner时才应用半透明效果
 */

/* 导航区域基础布局样式（避免 flex 子项溢出） */
.navbar-nav-links {
  min-width: 0;
  flex-shrink: 1;
  transition:
    opacity 0.3s ease,
    transform 0.3s ease,
    visibility 0.3s,
    gap 0.3s ease;
}

/* 按钮区域基础布局样式（避免 flex 子项溢出） */
.navbar-buttons {
  min-width: 0;
  flex-shrink: 0;
}

/* 顶栏标题样式：悬停时不变色 */
.navbar-logo {
  @apply text-black/75 dark:text-white/75 hover:!text-current;
}

#navbar > div {
  background: var(--card-bg);
  border-radius: var(--radius-large);
  will-change: background, backdrop-filter, box-shadow;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* 桌面端 - 亮色 */
@media (min-width: 1280px) {
  #banner-wrapper ~ * #navbar[data-transparent-mode="semi"] > div,
  body:has(#banner-wrapper) #navbar[data-transparent-mode="semi"] > div {
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(255, 255, 255, 0.55);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  }
}

/* 移动端 (仅首页) - 亮色 */
@media (max-width: 1279px) {
  #banner-wrapper ~ * #navbar[data-transparent-mode="semi"][data-is-home="true"] > div,
  body:has(#banner-wrapper) #navbar[data-transparent-mode="semi"][data-is-home="true"] > div {
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(255, 255, 255, 0.55);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  }
}

/* 桌面端 - 暗色 */
@media (min-width: 1280px) {
  :root.dark #banner-wrapper ~ * #navbar[data-transparent-mode="semi"] > div,
  :root.dark body:has(#banner-wrapper) #navbar[data-transparent-mode="semi"] > div {
    backdrop-filter: blur(20px);
    background: rgba(0, 0, 0, 0.55);
    border: 1px solid rgba(0, 0, 0, 0.55);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  }
}

/* 移动端 (仅首页) - 暗色 */
@media (max-width: 1279px) {
  :root.dark #banner-wrapper ~ * #navbar[data-transparent-mode="semi"][data-is-home="true"] > div,
  :root.dark body:has(#banner-wrapper) #navbar[data-transparent-mode="semi"][data-is-home="true"] > div {
    backdrop-filter: blur(20px);
    background: rgba(0, 0, 0, 0.55);
    border: 1px solid rgba(0, 0, 0, 0.55);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  }
}

/**
 * 导航栏全透明样式
 */

/* 桌面端 */
@media (min-width: 1280px) {
  #banner-wrapper ~ * #navbar[data-transparent-mode="full"] > div,
  body:has(#banner-wrapper) #navbar[data-transparent-mode="full"] > div,
  :root.dark #banner-wrapper ~ * #navbar[data-transparent-mode="full"] > div,
  :root.dark body:has(#banner-wrapper) #navbar[data-transparent-mode="full"] > div {
    background: transparent;
    box-shadow: none;
    border: 1px solid transparent;
    backdrop-filter: none;
  }
}

/* 移动端 (仅首页) */
@media (max-width: 1279px) {
  #banner-wrapper ~ * #navbar[data-transparent-mode="full"][data-is-home="true"] > div,
  body:has(#banner-wrapper) #navbar[data-transparent-mode="full"][data-is-home="true"] > div,
  :root.dark #banner-wrapper ~ * #navbar[data-transparent-mode="full"][data-is-home="true"] > div,
  :root.dark body:has(#banner-wrapper) #navbar[data-transparent-mode="full"][data-is-home="true"] > div {
    background: transparent;
    box-shadow: none;
    border: 1px solid transparent;
    backdrop-filter: none;
  }
}

/* --- 初始状态 (Initial) --- */
@media (min-width: 1280px) {
  #banner-wrapper ~ * #navbar[data-transparent-mode="semifull"] > div,
  body:has(#banner-wrapper) #navbar[data-transparent-mode="semifull"] > div {
    background: transparent;
    box-shadow: none;
    border: 1px solid transparent;
  }
}

@media (max-width: 1279px) {
  #banner-wrapper ~ * #navbar[data-transparent-mode="semifull"][data-is-home="true"] > div,
  body:has(#banner-wrapper) #navbar[data-transparent-mode="semifull"][data-is-home="true"] > div {
    background: transparent;
    box-shadow: none;
    border: 1px solid transparent;
  }
}

/* 桌面端 - 滚动后 */
@media (min-width: 1280px) {
  #banner-wrapper ~ * #navbar[data-transparent-mode="semifull"].scrolled > div,
  body:has(#banner-wrapper) #navbar[data-transparent-mode="semifull"].scrolled > div {
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(255, 255, 255, 0.55);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  }

  :root.dark #banner-wrapper ~ * #navbar[data-transparent-mode="semifull"].scrolled > div,
  :root.dark body:has(#banner-wrapper) #navbar[data-transparent-mode="semifull"].scrolled > div {
    background: rgba(0, 0, 0, 0.55);
    border: 1px solid rgba(0, 0, 0, 0.55);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  }
}

/* 移动端 - 滚动后 */
@media (max-width: 1279px) {
  #banner-wrapper ~ * #navbar[data-transparent-mode="semifull"][data-is-home="true"].scrolled > div,
  body:has(#banner-wrapper) #navbar[data-transparent-mode="semifull"][data-is-home="true"].scrolled > div {
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(255, 255, 255, 0.55);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  }

  :root.dark #banner-wrapper ~ * #navbar[data-transparent-mode="semifull"][data-is-home="true"].scrolled > div,
  :root.dark body:has(#banner-wrapper) #navbar[data-transparent-mode="semifull"][data-is-home="true"].scrolled > div {
    background: rgba(0, 0, 0, 0.55);
    border: 1px solid rgba(0, 0, 0, 0.55);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  }
}

/* 平板设备优化 */
@media (min-width: 768px) and (max-width: 1279px) {
  #navbar > div {
    border-radius: 1rem;
  }
}

/* 小屏手机优化 */
@media (max-width: 480px) {
  #navbar > div {
    border-radius: 0.5rem;
    margin: 0;
    padding-left: 1rem;
    padding-right: 1rem;
    max-width: none;
    width: 100%;
  }
}

/* 手机端导航栏全宽优化 */
@media (max-width: 768px) {
  #navbar > div {
    max-width: none;
    width: 100%;
    margin-left: 0;
    margin-right: 0;
  }
}

/* 通用样式 */
@media (min-width: 1280px) {
  #banner-wrapper ~ * .float-panel,
  body:has(#banner-wrapper) .float-panel,
  #banner-wrapper ~ * .dropdown-content,
  body:has(#banner-wrapper) .dropdown-content,
  #banner-wrapper ~ * #display-setting,
  body:has(#banner-wrapper) #display-setting,
  #banner-wrapper ~ * #nav-menu-panel,
  body:has(#banner-wrapper) #nav-menu-panel,
  #banner-wrapper ~ * #mobile-toc-panel,
  body:has(#banner-wrapper) #mobile-toc-panel,
  #banner-wrapper ~ * #search-panel,
  body:has(#banner-wrapper) #search-panel {
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.85);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  }

  /* 暗色模式 */
  :root.dark #banner-wrapper ~ * .float-panel,
  :root.dark body:has(#banner-wrapper) .float-panel,
  :root.dark #banner-wrapper ~ * .dropdown-content,
  :root.dark body:has(#banner-wrapper) .dropdown-content,
  :root.dark #banner-wrapper ~ * #display-setting,
  :root.dark body:has(#banner-wrapper) #display-setting,
  :root.dark #banner-wrapper ~ * #nav-menu-panel,
  :root.dark body:has(#banner-wrapper) #nav-menu-panel,
  :root.dark #banner-wrapper ~ * #mobile-toc-panel,
  :root.dark body:has(#banner-wrapper) #mobile-toc-panel,
  :root.dark #banner-wrapper ~ * #search-panel,
  :root.dark body:has(#banner-wrapper) #search-panel {
    background: rgba(24, 25, 38, 0.85);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.18);
  }
}

/* 移动端 (仅首页) */
@media (max-width: 1279px) {
  #banner-wrapper ~ * #navbar[data-is-home="true"] .float-panel,
  body:has(#banner-wrapper) #navbar[data-is-home="true"] .float-panel,
  #banner-wrapper ~ * #navbar[data-is-home="true"] .dropdown-content,
  body:has(#banner-wrapper) #navbar[data-is-home="true"] .dropdown-content,
  #banner-wrapper ~ * #navbar[data-is-home="true"] ~ * #display-setting,
  body:has(#banner-wrapper) #navbar[data-is-home="true"] ~ * #display-setting,
  body:has(#banner-wrapper) #navbar[data-is-home="true"] #nav-menu-panel,
  body:has(#banner-wrapper) #navbar[data-is-home="true"] #mobile-toc-panel,
  body:has(#banner-wrapper) #navbar[data-is-home="true"] #search-panel,
  body:has(#banner-wrapper) #navbar[data-is-home="true"] #display-setting {
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.85);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  }

  /* 暗色模式 */
  :root.dark #banner-wrapper ~ * #navbar[data-is-home="true"] .float-panel,
  :root.dark body:has(#banner-wrapper) #navbar[data-is-home="true"] .float-panel,
  :root.dark #banner-wrapper ~ * #navbar[data-is-home="true"] .dropdown-content,
  :root.dark body:has(#banner-wrapper) #navbar[data-is-home="true"] .dropdown-content,
  :root.dark #banner-wrapper ~ * #navbar[data-is-home="true"] ~ * #display-setting,
  :root.dark body:has(#banner-wrapper) #navbar[data-is-home="true"] ~ * #display-setting,
  :root.dark body:has(#banner-wrapper) #navbar[data-is-home="true"] #nav-menu-panel,
  :root.dark body:has(#banner-wrapper) #navbar[data-is-home="true"] #mobile-toc-panel,
  :root.dark body:has(#banner-wrapper) #navbar[data-is-home="true"] #search-panel,
  :root.dark body:has(#banner-wrapper) #navbar[data-is-home="true"] #display-setting {
    background: rgba(24, 25, 38, 0.85);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.18);
  }
}

@media (max-width: 1279px) {
  body.enable-banner #banner-wrapper ~ * #navbar[data-is-home="false"] > div,
  body.enable-banner:has(#banner-wrapper) #navbar[data-is-home="false"] > div {
    backdrop-filter: none;
    background: var(--card-bg);
    box-shadow: var(--shadow-sm);
  }

  body.enable-banner #banner-wrapper ~ * #navbar[data-is-home="false"] .float-panel,
  body.enable-banner:has(#banner-wrapper) #navbar[data-is-home="false"] .float-panel,
  body.enable-banner #banner-wrapper ~ * #navbar[data-is-home="false"] .dropdown-content,
  body.enable-banner:has(#banner-wrapper) #navbar[data-is-home="false"] .dropdown-content,
  body.enable-banner #banner-wrapper ~ * #navbar[data-is-home="false"] ~ * #display-setting,
  body.enable-banner:has(#banner-wrapper) #navbar[data-is-home="false"] ~ * #display-setting,
  body.enable-banner:has(#banner-wrapper) #navbar[data-is-home="false"] #nav-menu-panel,
  body.enable-banner:has(#banner-wrapper) #navbar[data-is-home="false"] #mobile-toc-panel,
  body.enable-banner:has(#banner-wrapper) #navbar[data-is-home="false"] #search-panel,
  body.enable-banner:has(#banner-wrapper) #navbar[data-is-home="false"] #display-setting {
    backdrop-filter: none;
    background: var(--card-bg);
    box-shadow: var(--shadow-sm);
  }
}

/* 响应式优化 */

/* 桌面端&平板端布局 */
@media (min-width: 768px) {
  /* 使用 Flex 布局实现精确的间距控制 */
  #navbar > div {
    display: flex !important;
    justify-content: space-between;
    align-items: center;
  }

  /* Logo区域到导航选项的间距 */
  #navbar > div > a:first-child {
    margin-right: clamp(1rem, 2vw, 2rem);
  }

  #navbar .navbar-nav-links {
    position: static;
    left: unset;
    transform: none;
    gap: 0.2rem;
    transition:
      opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
      transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
      filter 0.3s cubic-bezier(0.4, 0, 0.2, 1),
      visibility 0.3s,
      max-width 0.3s cubic-bezier(0.4, 0, 0.2, 1),
      gap 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    /* 导航选项到按钮的间距与Logo到导航选项相同 */
    margin-right: clamp(1rem, 2vw, 2rem);
    max-width: 100%;
  }

  /* 导航链接内部项的过渡 */
  #navbar .navbar-nav-links > * {
    transition:
      opacity 0.25s cubic-bezier(0.4, 0, 0.2, 1),
      transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }

  #navbar .navbar-buttons {
    gap: 0.2rem;
    /* 按钮区域不添加右边距 */
  }

  /* 搜索状态下的避让逻辑以防重叠 - 所有桌面尺寸 */
  #navbar.is-searching .navbar-nav-links {
    opacity: 0;
    transform: translateX(-2rem) scale(0.95);
    filter: blur(4px);
    pointer-events: none;
    visibility: hidden;
    max-width: 0;
    overflow: hidden;
    gap: 0;
  }

  /* 导航项依次淡出效果 */
  #navbar.is-searching .navbar-nav-links > *:nth-child(1) {
    transition-delay: 0ms;
  }
  #navbar.is-searching .navbar-nav-links > *:nth-child(2) {
    transition-delay: 20ms;
  }
  #navbar.is-searching .navbar-nav-links > *:nth-child(3) {
    transition-delay: 40ms;
  }
  #navbar.is-searching .navbar-nav-links > *:nth-child(4) {
    transition-delay: 60ms;
  }
  #navbar.is-searching .navbar-nav-links > *:nth-child(5) {
    transition-delay: 80ms;
  }

  #navbar.is-searching .navbar-nav-links > * {
    opacity: 0;
    transform: translateX(-1rem) scale(0.9);
  }
}

/* 大屏桌面端优化 */
@media (min-width: 1281px) {
  #navbar .navbar-nav-links {
    gap: 0.3rem;
  }

  #navbar .navbar-buttons {
    gap: 0.3rem;
  }
}

/* 非大屏桌面端&平板端优化 */
@media (min-width: 768px) and (max-width: 1280px) {
  #navbar .navbar-nav-links {
    gap: 0.2rem;
  }

  #navbar .navbar-buttons {
    gap: 0.2rem;
  }
}

/* 手机端导航栏 */
@media (max-width: 767px) {
  #navbar > div {
    max-width: none !important;
    width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
}
/* 手机端导航栏 - 小屏 */
@media (max-width: 511px) {
  #navbar > div {
    border-radius: 0.3rem !important;
    margin: 0 !important;
    max-width: none !important;
    width: 100% !important;
  }

  #navbar-buttons {
    gap: 0.123rem !important;
  }
  /* Only size the trigger buttons; do not affect nested buttons inside panels */
  #navbar-buttons button:not(.float-panel *) {
    width: 2.4rem !important;
    height: 2.4rem !important;
    padding: 0 !important;
  }

  /* home button */
  #navbar > div > a:first-child {
    width: 7.2rem !important;
    height: 2.4rem !important;
    padding: 0 !important;
  }
}

/* 手机端导航栏 - 更小屏 */
@media (min-width: 333px) and (max-width: 443px) {
  #navbar-buttons {
    gap: 0.111rem !important;
  }
  /* Only size the trigger buttons; do not affect nested buttons inside panels */
  #navbar-buttons button:not(.float-panel *) {
    width: 2.1rem !important;
    height: 2.1rem !important;
    padding: 0 !important;
  }

  /* home button */
  #navbar > div > a:first-child {
    width: 6.3rem !important;
    height: 2.1rem !important;
    padding: 0 !important;
  }
}

/* 手机端导航栏按钮 -超小屏 */
@media (max-width: 332px) {
  #navbar-buttons {
    gap: 0 !important;
    justify-content: flex-end !important;
  }

  /* Hide home button text (keep icon) */
  #navbar > div > a:first-child > div {
    font-size: 0 !important;
  }
}
